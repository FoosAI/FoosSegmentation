{
    "transforms":
    [
        {   "_comment_": "-------- Load foosball table images with segmentation --------"},
        {
            "name":"random_video_loader",
            "endswith":".mp4",
            "folder":".\\Raw\\RawMatchesContinuous\\",
            "output":"frame",
            "exclusions":["images"],
            "random":true,
            "value_loader":
            {
                "json":
                {
                    "constant":true,
                    "values_to_load":["rod_lines", "score_lines", "table"]
                }
            },
            "repeats":
            [
            ]
        },
        {
            "name":"require",
            "input":"frame"
        },

        {   "_comment_": "-------- Load random images --------"},
        {
            "name":"random_video_loader",
            "exclusions":[],
            "endswith":"images_0.mp4",
            "folder":".\\Raw\\RawMatchesContinuous\\",
            "output":"random_image",
            "random":true,
            "stop_at_end":false,
            "value_loader":
            {
            },
            "repeats":
            [
            ]
        },
        {
            "name":"require",
            "input":"random_image"
        },

        {   "_comment_": "-------- Match random image to frame size --------"},
        {
            "name":"resize_to_other",
            "input":"random_image",
            "output":"random_image",
            "size_reference":"frame",
            "resize_mode":"stretch"  
        },

        {   "_comment_": "-------- Build a larger contour of the table for transplanting it on a random background --------"},
        {
            "name":"polygon_to_contours",
            "input_polygon":"table",
            "output_contours":"table_larger"
        },
        {
            "name":"contours_adjust",
            "input_contours":"table_larger",
            "output_contours":"table_larger",
            "random_size_multiplier":[1.08, 1.30]
        },
        {
            "name":"first_contour_to_polygon",
            "input_contours":"table_larger",
            "output_polygon":"table_larger"
        },

        {   "_comment_": "-------- Transplant the table onto a random background image --------"},
        {
            "name":"merge_two_frames_by_polygon",
            "background_frame":"random_image",
            "frame_to_add":"frame",
            "output":"frame",
            "region_to_add":"table_larger"
        },

        {   "_comment_": "-------- Draw the segmentation --------"},
        {
            "name":"zeros_like",
            "reference":"frame",
            "output":"segmentation"
        },
        {
            "name":"draw_polygon",
            "input_frame":"segmentation",
            "input_polygon":"table",
            "fill":true,
            "width":1,
            "color":[255,0,0]
        },
        {
            "name":"draw_lines",
            "input_frame":"segmentation",
            "input_lines":"score_lines",
            "width":10,
            "color":[0,255,0]
        },
        {
            "name":"draw_lines",
            "input_frame":"segmentation",
            "input_lines":"rod_lines",
            "width":10,
            "color":[255,0,255]
        },

        {   "_comment_": "-------- Transplant the segmentation to match cut-out region --------"},
        {
            "name":"zeros_like",
            "reference":"frame",
            "output":"segmentation_empty"
        },
        {
            "name":"merge_two_frames_by_polygon",
            "background_frame":"segmentation_empty",
            "frame_to_add":"segmentation",
            "output":"segmentation",
            "region_to_add":"table_larger"
        },

        {   "_comment_": "-------- Downsize --------"},
        {
            "name":"resize",
            "input":"frame",
            "output":"frame",
            "size":[256,512],
            "resize_mode":"stretch"  
        },
        {
            "name":"resize",
            "input":"segmentation",
            "output":"segmentation",
            "size":[256,512],
            "resize_mode":"stretch"  
        },

        {   "_comment_": "-------- Output --------"},
        {
            "name":"basic_writer",
            "frames_to_output":["frame","segmentation"],
            "values_to_output":[],
            "folder":".\\Processed\\Segmentation\\",
            "filename_prefix":"segmentation_modified_background",
            "frames_per_chunk":500000
        }
    ]
}
